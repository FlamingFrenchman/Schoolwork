# Makefile, Author: Robert Bergeron, ID: rbergero

# Extremely picky compiler options
WARN = -Wall -Wextra -Werror -Wpedantic -Wshadow -Wold-style-cast
# full gcc exec command
CPP  = g++ -g -O0 -std=gnu++17 ${WARN} -fdiagnostics-color=never
DEPCPP = g++ -std=gnu++17 -MM ${WARN}
MKFILE = Makefile
DEPFILE = ${MKFILE}.dep
GMAKE = ${MAKE} --no-print-directory
# name of the compiled executable
EXECNAME = oc
# .cpp source files
CPPSRC = main.cpp auxlib.cpp string_set.cpp
# .h header files
HEADERS = auxlib.h string_set.h
# .gch header somethings?
GCH = auxlib.h.gch string_set.h.gch
# .o object files
OBJECTS = main.o auxlib.o string_set.o
# files generated by ex. flex and bison
# GENS = 

all : ${DEPFILE} ${EXECNAME}

${EXECNAME} : ${OBJECTS}
	${CPP} -o oc ${OBJECTS}

%.o : %.cpp
	${CPP} -c $< ${HEADERS}

clean :
	rm -f ${OBJECTS} ${GCH} ${DEPFILE}

ci :
	git add ${HEADERS} ${CPPSRC} ${MKFILE}

spotless : clean
	rm -f ${EXECNAME}

deps : ${CPPSRC}
	${DEPCPP} ${HEADERS} ${CPPSRC} ${MKFILE} >> ${DEPFILE}

${DEPFILE} :
	@ touch ${DEPFILE}
	${GMAKE} deps
